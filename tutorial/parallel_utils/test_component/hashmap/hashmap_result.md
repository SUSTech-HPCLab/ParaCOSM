# 测试hash表的并行读写能力

使用 test_hashmap.cpp 文件进行测试，结果如下：


## 单线程下读写情况

| 实验编号 | 互斥锁 | 数据竞争 | 读写操作 | 运行情况 | 备注 |
|----------|--------|----------|----------|----------------|------|
| 1        | 有     | 无       | 读       |        成功        |      |
| 2        | 有     | 无       | 写       |        成功       |      |
| 3        | 有     | 有       | 读       |  成功        |      |
| 4        | 有     | 有       | 写    |   成功     |   第一个线程写入成功   |
| 5        | 无     | 无       | 读       |       成功         |      |
| 6        | 无     | 无       | 写       |       成功         |      |
| 7        | 无     | 有       | 读       |    成功            |      |
| 8        | 无     | 有       | 写       |    成功   |  第一个线程写入成功   |

## 多线程下读写情况

| 实验编号 | 互斥锁 | 数据竞争 | 读写操作 | 运行情况 | 备注 |
|----------|--------|----------|----------|----------------|------|
| 1        | 有     | 无       | 读       |        成功        |      |
| 2        | 有     | 无       | 写       |        成功       |      |
| 3        | 有     | 有       | 读       |  成功        |      |
| 4        | 有     | 有       | 写    |   成功     |   可能会写入不同数值   |
| 5        | 无     | 无       | 读       |       成功   |  数据输出完全无序    |
| 6        | 无     | 无       | 写       |       成功   |  数据输出完全无序    |
| 7        | 无     | 有       | 读       |    成功            |  数据输出完全无序    |
| 8        | 无     | 有       | 写       |    有概率失败   |   Segmentation fault  |


## `std::unordered_map<int, std::vector<int>>` 测试

每次对哈希表内的数组进行读取及修改


| 实验编号 | 互斥锁 | 数据竞争 | 读写操作 | 运行时间（秒） | 备注 |
|----------|--------|----------|----------|----------------|------|
| 1        | 有     | 无       | 读       |     成功           |      |
| 2        | 有     | 无       | 写       |     成功           |      |
| 3        | 有     | 有       | 读       |       成功         |      |
| 4        | 有     | 有       | 写       |        成功        |   可能会写入不同数值   |
| 5        | 无     | 无       | 读       |     成功           |  数据输出完全无序    |
| 6        | 无     | 无       | 写       |     成功           |  数据输出完全无序    |
| 7        | 无     | 有       | 读       |   有概率失败             | Segmentation fault或者 free(): double free detected in tcache 2    |
| 8        | 无     | 有       | 写       |    有小概率失败            |  Segmentation fault    |


## Vector 并行测试


## Vector<unordermap>测试

我们可以换hash table

可以改变哈希表顺序

可以改safe update
可以